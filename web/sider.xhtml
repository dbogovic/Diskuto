<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:a="http://xmlns.jcp.org/jsf/passthrough"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
    <h:outputStylesheet library="css" name="global.css"/>
    <h:outputStylesheet library="css" name="sider.css"/>
    <h:form id="sider" prependId="false">
        <h:panelGroup rendered="#{!home.login}">
            <h:panelGrid id="loginTable" columns="2">
                <h:outputText value="Korisničko ime:"/>
                <h:inputText id="username" value="#{home.username}"/>

                <h:outputText value="Lozinka:"/>
                <h:inputSecret id="password" value="#{home.password}" />
            </h:panelGrid>
            <h:commandButton id="loginButton" class="button" value="Prijavi se" action="#{home.doLogin}">
                <f:ajax event="action" execute="username password" render="@form"/>
            </h:commandButton>
            <img id="ajaxloader" src="./resources/pages/loading.gif" />
            <c:forEach items="#{home.errorText}" var="value">
                <h:outputText class="errorText" value="#{value}" />
            </c:forEach>
            <h:link value="Zaboravili ste lozinku?" outcome="newPassword" />
            <h:link value="Nemate korisnički račun?" outcome="registration" />
            <script>
                jsf.ajax.addOnEvent(function (data) {
                    var ajaxstatus = data.status;
                    var ajaxloader = document.getElementById("ajaxloader");

                    switch (ajaxstatus) {
                        case "begin":
                            ajaxloader.style.display = 'initial';
                            break;
                        case "complete":
                            ajaxloader.style.display = 'none';
                            break;
                        case "success":
                            break;
                    }
                });
            </script>
        </h:panelGroup>
        <h:panelGroup rendered="#{home.login}">
            <div class="menu">
                <h:graphicImage value="resources/pages/favicon.ico" />
                <h:link class="menu-option" value="Moja diskuta" outcome="myDiskuto" />
            </div>
            <div class="diskutos-parent">
                <c:forEach items="#{myDiskuto.owner}" var="value">
                    <h:link class="diskutos" value="#{value}" outcome="forum" >
                        <f:param name="name" value="#{value}" />
                    </h:link>
                </c:forEach>
                <c:forEach items="#{myDiskuto.moderator}" var="value">
                    <h:link class="diskutos" value="#{value}" outcome="forum" >
                        <f:param name="name" value="#{value}" />
                    </h:link>
                </c:forEach>
            </div>
            <div class="menu">
                <h:graphicImage value="resources/pages/plus.png" />
                <h:link class="menu-option" value="Pretplaćena diskuta" outcome="discover" />
            </div>
            <div class="diskutos-parent">
                <c:forEach items="#{home.user.subscriptions}" var="value">
                    <h:link class="diskutos" value="#{value}" outcome="forum" >
                        <f:param name="name" value="#{value}" />
                    </h:link>
                </c:forEach>
            </div>
            <div class="menu">
                <h:graphicImage value="resources/pages/message.png" />
                <h:link class="menu-option" value="Moje poruke" outcome="message" />
                <h:outputText rendered="#{home.user.unread > 0}" id="nmbMessages" value="#{home.user.unread}" />
            </div>
            <div class="menu">
                <h:graphicImage value="resources/pages/settings.png" />
                <h:link class="menu-option" value="Postavke" outcome="settings" />
            </div>
        </h:panelGroup>
    </h:form>
</ui:composition>